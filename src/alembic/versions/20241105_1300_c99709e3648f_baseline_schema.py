"""baseline_schema

Revision ID: c99709e3648f
Revises: 
Create Date: 2024-11-05 13:00:06.356164

"""
from typing import Sequence, Union

import sqlalchemy as sa

from alembic import op

# revision identifiers, used by Alembic.
revision: str = "c99709e3648f"
down_revision: Union[str, None] = None
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table("MediaItem",
    sa.Column("id", sa.String(), nullable=False),
    sa.Column("imdb_id", sa.String(), nullable=True),
    sa.Column("tvdb_id", sa.String(), nullable=True),
    sa.Column("tmdb_id", sa.String(), nullable=True),
    sa.Column("number", sa.Integer(), nullable=True),
    sa.Column("type", sa.String(), nullable=False),
    sa.Column("requested_at", sa.DateTime(), nullable=True),
    sa.Column("requested_by", sa.String(), nullable=True),
    sa.Column("requested_id", sa.Integer(), nullable=True),
    sa.Column("indexed_at", sa.DateTime(), nullable=True),
    sa.Column("scraped_at", sa.DateTime(), nullable=True),
    sa.Column("scraped_times", sa.Integer(), nullable=True),
    sa.Column("active_stream", sa.JSON(), nullable=True),
    sa.Column("symlinked", sa.Boolean(), nullable=True),
    sa.Column("symlinked_at", sa.DateTime(), nullable=True),
    sa.Column("symlinked_times", sa.Integer(), nullable=True),
    sa.Column("symlink_path", sa.String(), nullable=True),
    sa.Column("file", sa.String(), nullable=True),
    sa.Column("folder", sa.String(), nullable=True),
    sa.Column("alternative_folder", sa.String(), nullable=True),
    sa.Column("aliases", sa.JSON(), nullable=True),
    sa.Column("is_anime", sa.Boolean(), nullable=True),
    sa.Column("title", sa.String(), nullable=True),
    sa.Column("network", sa.String(), nullable=True),
    sa.Column("country", sa.String(), nullable=True),
    sa.Column("language", sa.String(), nullable=True),
    sa.Column("aired_at", sa.DateTime(), nullable=True),
    sa.Column("year", sa.Integer(), nullable=True),
    sa.Column("genres", sa.JSON(), nullable=True),
    sa.Column("key", sa.String(), nullable=True),
    sa.Column("guid", sa.String(), nullable=True),
    sa.Column("update_folder", sa.String(), nullable=True),
    sa.Column("overseerr_id", sa.Integer(), nullable=True),
    sa.Column("last_state", sa.Enum("Unknown", "Unreleased", "Ongoing", "Requested", "Indexed", "Scraped", "Downloaded", "Symlinked", "Completed", "PartiallyCompleted", "Failed", name="states"), nullable=True),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_index("ix_mediaitem_aired_at", "MediaItem", ["aired_at"], unique=False)
    op.create_index("ix_mediaitem_country", "MediaItem", ["country"], unique=False)
    op.create_index("ix_mediaitem_imdb_id", "MediaItem", ["imdb_id"], unique=False)
    op.create_index("ix_mediaitem_language", "MediaItem", ["language"], unique=False)
    op.create_index("ix_mediaitem_network", "MediaItem", ["network"], unique=False)
    op.create_index("ix_mediaitem_overseerr_id", "MediaItem", ["overseerr_id"], unique=False)
    op.create_index("ix_mediaitem_requested_by", "MediaItem", ["requested_by"], unique=False)
    op.create_index("ix_mediaitem_title", "MediaItem", ["title"], unique=False)
    op.create_index("ix_mediaitem_tmdb_id", "MediaItem", ["tmdb_id"], unique=False)
    op.create_index("ix_mediaitem_tvdb_id", "MediaItem", ["tvdb_id"], unique=False)
    op.create_index("ix_mediaitem_type", "MediaItem", ["type"], unique=False)
    op.create_index("ix_mediaitem_type_aired_at", "MediaItem", ["type", "aired_at"], unique=False)
    op.create_index("ix_mediaitem_year", "MediaItem", ["year"], unique=False)
    op.create_table("Stream",
    sa.Column("id", sa.Integer(), nullable=False),
    sa.Column("infohash", sa.String(), nullable=False),
    sa.Column("raw_title", sa.String(), nullable=False),
    sa.Column("parsed_title", sa.String(), nullable=False),
    sa.Column("rank", sa.Integer(), nullable=False),
    sa.Column("lev_ratio", sa.Float(), nullable=False),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_index("ix_stream_infohash", "Stream", ["infohash"], unique=False)
    op.create_index("ix_stream_parsed_title", "Stream", ["parsed_title"], unique=False)
    op.create_index("ix_stream_rank", "Stream", ["rank"], unique=False)
    op.create_index("ix_stream_raw_title", "Stream", ["raw_title"], unique=False)
    op.create_table("Movie",
    sa.Column("id", sa.String(), nullable=False),
    sa.ForeignKeyConstraint(["id"], ["MediaItem.id"], ),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_table("Show",
    sa.Column("id", sa.String(), nullable=False),
    sa.ForeignKeyConstraint(["id"], ["MediaItem.id"], ),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_table("StreamBlacklistRelation",
    sa.Column("id", sa.Integer(), nullable=False),
    sa.Column("media_item_id", sa.String(), nullable=False),
    sa.Column("stream_id", sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(["media_item_id"], ["MediaItem.id"], ondelete="CASCADE"),
    sa.ForeignKeyConstraint(["stream_id"], ["Stream.id"], ondelete="CASCADE"),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_index("ix_streamblacklistrelation_media_item_id", "StreamBlacklistRelation", ["media_item_id"], unique=False)
    op.create_index("ix_streamblacklistrelation_stream_id", "StreamBlacklistRelation", ["stream_id"], unique=False)
    op.create_table("StreamRelation",
    sa.Column("id", sa.Integer(), nullable=False),
    sa.Column("parent_id", sa.String(), nullable=False),
    sa.Column("child_id", sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(["child_id"], ["Stream.id"], ondelete="CASCADE"),
    sa.ForeignKeyConstraint(["parent_id"], ["MediaItem.id"], ondelete="CASCADE"),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_index("ix_streamrelation_child_id", "StreamRelation", ["child_id"], unique=False)
    op.create_index("ix_streamrelation_parent_id", "StreamRelation", ["parent_id"], unique=False)
    op.create_table("Subtitle",
    sa.Column("id", sa.Integer(), nullable=False),
    sa.Column("language", sa.String(), nullable=False),
    sa.Column("file", sa.String(), nullable=True),
    sa.Column("parent_id", sa.String(), nullable=False),
    sa.ForeignKeyConstraint(["parent_id"], ["MediaItem.id"], ondelete="CASCADE"),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_index("ix_subtitle_file", "Subtitle", ["file"], unique=False)
    op.create_index("ix_subtitle_language", "Subtitle", ["language"], unique=False)
    op.create_index("ix_subtitle_parent_id", "Subtitle", ["parent_id"], unique=False)
    op.create_table("Season",
    sa.Column("id", sa.String(), nullable=False),
    sa.Column("parent_id", sa.String(), nullable=False),
    sa.ForeignKeyConstraint(["id"], ["MediaItem.id"], ),
    sa.ForeignKeyConstraint(["parent_id"], ["Show.id"], ),
    sa.PrimaryKeyConstraint("id")
    )
    op.create_table("Episode",
    sa.Column("id", sa.String(), nullable=False),
    sa.Column("parent_id", sa.String(), nullable=False),
    sa.ForeignKeyConstraint(["id"], ["MediaItem.id"], ),
    sa.ForeignKeyConstraint(["parent_id"], ["Season.id"], ),
    sa.PrimaryKeyConstraint("id")
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table("Episode")
    op.drop_table("Season")
    op.drop_index("ix_subtitle_parent_id", table_name="Subtitle")
    op.drop_index("ix_subtitle_language", table_name="Subtitle")
    op.drop_index("ix_subtitle_file", table_name="Subtitle")
    op.drop_table("Subtitle")
    op.drop_index("ix_streamrelation_parent_id", table_name="StreamRelation")
    op.drop_index("ix_streamrelation_child_id", table_name="StreamRelation")
    op.drop_table("StreamRelation")
    op.drop_index("ix_streamblacklistrelation_stream_id", table_name="StreamBlacklistRelation")
    op.drop_index("ix_streamblacklistrelation_media_item_id", table_name="StreamBlacklistRelation")
    op.drop_table("StreamBlacklistRelation")
    op.drop_table("Show")
    op.drop_table("Movie")
    op.drop_index("ix_stream_raw_title", table_name="Stream")
    op.drop_index("ix_stream_rank", table_name="Stream")
    op.drop_index("ix_stream_parsed_title", table_name="Stream")
    op.drop_index("ix_stream_infohash", table_name="Stream")
    op.drop_table("Stream")
    op.drop_index("ix_mediaitem_year", table_name="MediaItem")
    op.drop_index("ix_mediaitem_type_aired_at", table_name="MediaItem")
    op.drop_index("ix_mediaitem_type", table_name="MediaItem")
    op.drop_index("ix_mediaitem_tvdb_id", table_name="MediaItem")
    op.drop_index("ix_mediaitem_tmdb_id", table_name="MediaItem")
    op.drop_index("ix_mediaitem_title", table_name="MediaItem")
    op.drop_index("ix_mediaitem_requested_by", table_name="MediaItem")
    op.drop_index("ix_mediaitem_overseerr_id", table_name="MediaItem")
    op.drop_index("ix_mediaitem_network", table_name="MediaItem")
    op.drop_index("ix_mediaitem_language", table_name="MediaItem")
    op.drop_index("ix_mediaitem_imdb_id", table_name="MediaItem")
    op.drop_index("ix_mediaitem_country", table_name="MediaItem")
    op.drop_index("ix_mediaitem_aired_at", table_name="MediaItem")
    op.drop_table("MediaItem")
    # ### end Alembic commands ###
